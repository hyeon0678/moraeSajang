<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC	"-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd"
>
<mapper namespace="kr.co.morae.admin.dao.AnalysisDao">
<select id="adminanalysisAdress" resultType="kr.co.morae.admin.dto.RegionAnalysisDto">
<![CDATA[
	SELECT re.gbDetailAddress , count(re.gbNo)AS topAddress FROM groupbuyingpost g INNER JOIN groupbuyingregions re ON g.gbNo = re.gbNo 
	WHERE g.gbState = '완료' AND g.finishDate >= #{param1} AND g.finishDate <=#{param2}
	GROUP BY re.gbDetailAddress HAVING count(re.gbNo) ORDER BY count(re.gbNo) desc LIMIT 6
]]>	
</select>
<select id="categorydraw" resultType="kr.co.morae.admin.dto.CategoryAnalysisDto">
	SELECT categoryType FROM category
</select>
</mapper>